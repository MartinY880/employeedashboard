// ProConnect — MortgagePros Employee Portal
// Prisma Schema for PostgreSQL

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ─── Models ───────────────────────────────────────────────

model User {
  id          String   @id @default(cuid())
  logtoId     String   @unique
  email       String   @unique
  displayName String
  role        Role     @default(EMPLOYEE)
  avatarUrl   String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  kudosSent     KudosMessage[] @relation("KudosAuthor")
  kudosReceived KudosMessage[] @relation("KudosRecipient")
  alertsCreated Alert[]

  @@map("users")
}

model KudosMessage {
  id          String   @id @default(cuid())
  content     String
  authorId    String
  recipientId String
  author      User     @relation("KudosAuthor", fields: [authorId], references: [id])
  recipient   User     @relation("KudosRecipient", fields: [recipientId], references: [id])
  likes       Int      @default(0)
  createdAt   DateTime @default(now())

  @@index([authorId])
  @@index([recipientId])
  @@index([createdAt])
  @@map("kudos_messages")
}

model Alert {
  id        String    @id @default(cuid())
  title     String
  content   String
  type      AlertType @default(INFO)
  priority  Priority  @default(LOW)
  active    Boolean   @default(true)
  createdBy String
  author    User      @relation(fields: [createdBy], references: [id])
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([active, priority])
  @@index([createdBy])
  @@map("alerts")
}

model Idea {
  id          String     @id @default(cuid())
  title       String
  description String
  authorId    String
  authorName  String
  votes       Int        @default(0)
  status      IdeaStatus @default(ACTIVE)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  @@index([status, votes])
  @@index([createdAt])
  @@map("ideas")
}

model QuickLink {
  id        String   @id @default(cuid())
  label     String
  url       String
  icon      String   @default("link")
  sortOrder Int      @default(0)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([active, sortOrder])
  @@map("quick_links")
}

model EmployeeHighlight {
  id           String   @id @default(cuid())
  employeeId   String?
  employeeName String
  jobTitle     String?
  department   String?
  title        String
  subtitle     String
  avatarUrl    String?
  active       Boolean  @default(true)
  startDate    DateTime @default(now())
  endDate      DateTime?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([active, startDate])
  @@map("employee_highlights")
}

// ─── Enums ────────────────────────────────────────────────

enum Role {
  ADMIN
  EMPLOYEE
}

enum AlertType {
  INFO
  WARNING
  BIRTHDAY
  NEW_HIRE
  ANNOUNCEMENT
}

enum Priority {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum IdeaStatus {
  ACTIVE
  SELECTED
  ARCHIVED
}
